# âš¡ SparkForge 2.0: AI é©±åŠ¨çš„å†³ç­–ä¸æ‰§è¡Œè§„åˆ’å¼•æ“

> **Mission**: å°†æŒ¥å‘æ€§çš„åŸå§‹åˆ›æ„ï¼ˆVaporous Ideasï¼‰é”»é€ æˆå·¥ä¸šçº§çš„æ‰§è¡Œæ–¹æ¡ˆï¼ˆIndustrial-Grade Execution Plansï¼‰ã€‚

---

## ğŸ§  é¡¹ç›®æ„¿æ™¯

SparkForge æ˜¯ä¸€ä¸ªé«˜ä¿çœŸæ™ºèƒ½å¼•æ“æ¡†æ¶ï¼Œæ—¨åœ¨é€šè¿‡ **AI è¾©è®º (Adversarial AI)**ã€**è‡ªåŠ¨åŒ–å·¥ä½œæµ** å’Œ **æ·±åº¦éªŒè¯ä½“ç³»**ï¼ŒååŠ©ç»„ç»‡å°†å¤æ‚æƒ³æ³•è½¬åŒ–ä¸ºé«˜ä¿çœŸã€å¯æ‰§è¡Œçš„ä¸“ä¸šåŒ–æ–¹æ¡ˆã€‚

## ğŸ› ï¸ æ ¸å¿ƒæ¶æ„ï¼šSparkForge-3 æ¡†æ¶

æœ¬é¡¹ç›®éµå¾ªä¸¥è‹›çš„ **Forge-3 æµç¨‹**ï¼Œç¡®ä¿æ¯ä¸€ä»½äº§å‡ºéƒ½å…·å¤‡å®æˆ˜ä»·å€¼ï¼š

1.  **Expansion (The Flesh - æ‰©å¼ )**: 
    *   åˆ›æ–°æ€§å¢å¼ºï¼šåœ¨åŸå§‹éœ€æ±‚åŸºç¡€ä¸Šå¢åŠ é«˜ä»·å€¼é€»è¾‘ç»„ä»¶ã€‚
    *   æ¶æ„è“å›¾ï¼šä½¿ç”¨ Mermaid.js å¯è§†åŒ–é€»è¾‘æµã€‚
2.  **Validation (The Bone - éªŒè¯)**:
    *   æ‰¹åˆ¤æ€§å®¡è®¡ï¼šé€šè¿‡ AI å§”å‘˜ä¼š (The Council) è¿›è¡Œå¤šç»´åº¦å®¡æ ¸ï¼Œè¯†åˆ«å•ç‚¹æ•…éšœã€‚
    *   ç¡¬æ ¸è§„é¿ï¼šæä¾›ç»è¿‡å‹åŠ›æµ‹è¯•çš„è§£å†³æ–¹æ¡ˆã€‚
3.  **Action (The Path - è¡ŒåŠ¨)**:
    *   ğŸ’§ **Atomic Safety**: å®ç°äº†æ–‡æ¡£ä¸å†å²è®°å½•çš„â€œåŸå­åŒ–å¤‡ä»½ä¸å›æ»šâ€ï¼Œç¡®ä¿ä¼˜åŒ–å¤±è´¥æ—¶çŠ¶æ€å¯æ§ã€‚
    *   å³æ—¶è·¯å¾„ï¼šäº§å‡ºä»¥åŠ¨è¯å¼€å¤´çš„ç»“æ„åŒ–ä»»åŠ¡çŸ©é˜µã€‚
    *   ä¸Šä¸‹æ–‡æ„ŸçŸ¥ï¼šç¡®ä¿æ‰€æœ‰è·¯å¾„ä¸ç°æœ‰å·¥ç¨‹ç»“æ„ï¼ˆ`/scripts`, `/docs`ï¼‰æ— ç¼å¯¹é½ã€‚

---

## ğŸ“‚ æ ¸å¿ƒèµ„æºè¯´æ˜

| ç›®å½•/æ–‡ä»¶      | åŠŸèƒ½å®šä¹‰      | å…³é”®ç»„ä»¶                                                             |
| :------------- | :------------ | :------------------------------------------------------------------- |
| **`.agent/`**  | æ™ºèƒ½ä½“å·¥ä½œæµ  | `optimize-design-loop.md`: æ”¯æŒåŸå­åŒ–å›æ»šã€å†²çªæ£€æµ‹ä¸å†å²å‹ç¼©ã€‚      |
| **`docs/`**    | æ–‡æ¡£èµ„äº§åº“    | `reports/`: é‡‡ç”¨ç›¸å¯¹è·¯å¾„å‘½åç©ºé—´çš„è¾©è®ºè®°å½•ï¼›`backup/`: è¿­ä»£å¿«ç…§ã€‚    |
| **`scripts/`** | è‡ªåŠ¨åŒ–å·¥å…·é›†  | `dialecta_debate.py`: æ”¯æŒå¼•æ–‡è¶Šç•Œæ£€æµ‹ã€é€»è¾‘è„‰å†²è¾“å‡ºä¸æ—¥å¿—è‡ªåŠ¨æ¸…ç†ã€‚ |
| **`prompts/`** | Prompt ç®¡ç†å±‚ | `adjudicator.md`: å¼ºåŒ–å¼•æ–‡è¦æ±‚ä¸å­˜åœ¨æ€§å®¡æŸ¥æŒ‡ä»¤ã€‚                     |
| **`llm/`**     | LLM æŠ½è±¡å±‚    | ç»Ÿä¸€äº¤äº’æ¥å£ã€ä¾›åº”å•†é…ç½®ç®¡ç†ä¸å¤šæ¨¡å‹é€‚é…ã€‚                           |

---

## ğŸ—ï¸ åŸºç¡€æ¶æ„ï¼šåº•å±‚æ”¯æ’‘å·¥å…·

SparkForge çš„ç¨³å®šæ€§ä¸çµæ´»æ€§å»ºç«‹åœ¨ä¸¤ä¸ªæ ¸å¿ƒåº•å±‚æ”¯æ’‘å±‚ä¹‹ä¸Šï¼š

```mermaid
graph TD
    %% å®šä¹‰é¡¶å±‚åº”ç”¨
    subgraph App_Layer [åº”ç”¨ä¸ç¼–æ’å±‚]
        direction TB
        Workflow[.agent/ä¼˜åŒ–å·¥ä½œæµ] --> Script[è¾©è®ºè„šæœ¬]
    end

    %% ä¸­é—´æ”¯æ’‘å±‚å¹¶è¡Œæ’åˆ—
    subgraph Infrastructure [åº•å±‚æ ¸å¿ƒæ”¯æ’‘]
        direction LR
        subgraph Prompt_Layer [Prompt ç®¡ç†å±‚]
            direction TB
            Loader[PromptLoader è‡ªåŠ¨è§£æ]
            Roles[è§’è‰²æŒ‡ä»¤é›†: æ­£æ–¹/åæ–¹/è¯„å®¡]
            Loader <--> Roles
        end

        subgraph LLM_Layer [LLM æŠ½è±¡å±‚]
            direction TB
            Client[LLMClient ç»Ÿä¸€æ¥å£]
            Config[config.json è¿è¡Œæ—¶å‚æ•°]
            Client <--> Config
        end
    end

    %% åº•å±‚æ¨¡å‹é›†æˆ
    subgraph Model_Base [åº•å±‚æ¨¡å‹é›†æˆ]
        direction LR
        M1[Gemini 3.5 Pro]
        M2[DeepSeek Chat]
        M3[GLM-4.6]
    end

    %% æ ¸å¿ƒäº¤äº’é“¾è·¯
    Script ==>|1. åŠ è½½æŒ‡ä»¤| Prompt_Layer
    Script ==>|2. æ‰§è¡Œæ¨ç†| LLM_Layer
    LLM_Layer ==>|3. API è°ƒç”¨| Model_Base

    %% æ ·å¼ç¾åŒ–
    style App_Layer fill:#f8f9fa,stroke:#343a40,stroke-width:2px
    style Prompt_Layer fill:#e7f3ff,stroke:#007bff,stroke-width:2px
    style LLM_Layer fill:#fff9db,stroke:#f08c00,stroke-width:2px
    style Model_Base fill:#ebfbee,stroke:#40c057,stroke-width:2px
    style Infrastructure fill:none,stroke:#ced4da,stroke-dasharray: 5 5
```

### 1. LLM æŠ½è±¡å±‚ (`llm/`)
*   **ç»Ÿä¸€äº¤äº’è¯­ä¹‰**: å°è£…äº† `chat` (åŒæ­¥) ä¸ `achat` (å¼‚æ­¥) æ¥å£ï¼Œå±è”½äº†ä¸åŒ LLM ä¾›åº”å•†çš„æ¥å£å·®å¼‚ã€‚
*   **Provider é…ç½®ç®¡ç†**: é€šè¿‡ `llm/config.json` é›†ä¸­ç®¡ç†æ¨¡å‹å‚æ•°ï¼ˆå¦‚ Temperature, Max Tokensï¼‰ä¸æ¥å…¥åœ°å€ã€‚æ”¯æŒ `${ENV_VAR}` å ä½ç¬¦è§£æï¼Œç¡®ä¿ API Key ç­‰æœºå¯†ä¿¡æ¯çš„ç¯å¢ƒæ³¨å…¥ã€‚
*   **é²æ£’æ€§æœºåˆ¶**: å®ç°äº†è¯·æ±‚å‚æ•°çš„æ·±åº¦åˆå¹¶ã€é”™è¯¯å¤„ç†ä¸ Usage ç»Ÿè®¡ï¼Œä¸ºä¸Šå±‚ `dialecta_debate.py` æä¾›å¯é çš„æ¨ç†åº•åº§ã€‚

### 2. Prompt ç®¡ç†å±‚ (`prompts/`)
*   **Markdown-as-Code**: é‡‡ç”¨ Markdown å­˜å‚¨ System Promptsï¼Œæå¤§æå‡äº†æŒ‡ä»¤å†…å®¹çš„å¯è¯»æ€§ä¸å¯ç»´æŠ¤æ€§ã€‚
*   **å…ƒæ•°æ®è§£è€¦**: é€šè¿‡ Markdown é¡¶éƒ¨çš„ **YAML Front Matter** å®šä¹‰è¯¥è§’è‰²æ¨èçš„æ¨¡å‹é…ç½®ï¼ˆå¦‚ `model`, `provider`ï¼‰ï¼Œå®ç°äº†â€œæç¤ºè¯å†…å®¹â€ä¸â€œæ¨ç†ç¡¬ä»¶å‚æ•°â€çš„æ·±åº¦è€¦åˆã€‚
*   **è‡ªåŠ¨è§£æå™¨**: å†…éƒ¨ `PromptLoader` ä¼šè‡ªåŠ¨æ‰«æç›®å½•ä¸‹çš„æ‰€æœ‰ Markdown æ–‡ä»¶ï¼Œå°†å…¶åŠ¨æ€è§£æä¸ºç»“æ„åŒ–å¯¹è±¡ã€‚å†…å®¹ä¸“å®¶å¯ä»¥ç›´æ¥åœ¨ Git ä¸­é€šè¿‡ä¿®æ”¹ Markdown æ¥è°ƒæ•´ AI è¡Œä¸ºï¼Œæ— éœ€æ¥è§¦æ ¸å¿ƒé€»è¾‘ä»£ç ã€‚

---

## ğŸš€ æ ¸å¿ƒå·¥ä½œæµï¼šDialecta è¾©è®ºä¼˜åŒ–å¾ªç¯

SparkForge çš„æ ¸å¿ƒä»·å€¼åœ¨äºå…¶ **â€œå¯¹æŠ—å¼ä¼˜åŒ–â€ (Adversarial Optimization)** æœºåˆ¶ã€‚è¯¥æµç¨‹ç»“åˆäº†è„šæœ¬é©±åŠ¨çš„ AI è¾©è®ºä¸ Agent é©±åŠ¨çš„æ–‡æ¡£æ‰‹æœ¯ï¼Œå½¢æˆä¸€ä¸ªé—­ç¯çš„è¿­ä»£ç³»ç»Ÿã€‚

### 1. å®Œæ•´æµç¨‹æ€»è§ˆ (Sequence Diagram)

```mermaid
sequenceDiagram
    autonumber
    participant Agent as Agent (The Surgeon)
    participant Script as dialecta_debate.py
    participant Council as The Council (LLM Group)
    participant Doc as Target Document
    participant History as history_summary.md

    rect rgb(240, 240, 240)
    Note over Agent, History: é˜¶æ®µä¸€ï¼šä¸Šä¸‹æ–‡æ„ŸçŸ¥ (Contextualization)
    Agent->>Agent: Step 1: æ»šåŠ¨å†å²è£å‰ª (Pruning) & å‹ç¼©
    Agent->>Script: è§¦å‘åä½œ (æ³¨å…¥å½“å‰ç›®æ ‡ + è£å‰ªååˆ¤ä¾‹)
    end

    rect rgb(248, 248, 255)
    Note over Script, Council: é˜¶æ®µäºŒï¼šå®‰å…¨ä¸å¯¹æŠ— (Safety & Debate)
    Script->>Script: å‘½åç©ºé—´éš”ç¦» (Namespace Isolation)
    par æ­£åæ–¹åšå¼ˆ (Parallel Execution)
        Script->>Council: æ­£æ–¹ (Affirmative)
        Script->>Council: åæ–¹ (Negative)
    end
    Council-->>Script: è¯„å®¡å®˜: è£å†³ (Verdict) & çº¿æ¡å¼•æ–‡è€ƒæ ¸
    Script->>Script: å¼•æ–‡å¹»è§‰å®¡è®¡ (Line Bounds Check)
    Script-->>Agent: è¾“å‡ºé€»è¾‘è„‰å†² (Logic Pulse) & æŠ¥å‘Š
    end

    rect rgb(224, 255, 224)
    Note over Agent, Doc: é˜¶æ®µä¸‰ï¼šåŸå­åŒ–æ¼”è¿› (Atomic Evolution)
    Agent->>Agent: Step 3: åˆ†æ•°å®¡è®¡ (å¦‚ Delta < -10 -> åŸå­åŒ–å›æ»š)
    Agent->>Doc: å¤–ç§‘æ‰‹æœ¯å¼æ”¹å†™ (Surgeon Logic)
    Agent->>History: æ›´æ–° Action Trace (è®°å½•æ”¹å†™æ„å›¾)
    end

    alt åˆ†æ•° < 90?
        Agent->>Agent: æºå¸¦â€œå½±å“çŸ©é˜µâ€è¿›å…¥ä¸‹ä¸€è½®
    else æˆåŠŸè¾¾æ ‡
        Agent-->>User: äº§å‡ºæœ€ç»ˆå®šç¨¿
    end
```

### 2. è¾©è®ºè„šæœ¬å†…éƒ¨é€»è¾‘ (`dialecta_debate.py`)
è„šæœ¬ä¸ä»…æ˜¯ä¸€ä¸ªè°ƒç”¨å™¨ï¼Œå®ƒåœ¨å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª **â€œç»“æ„åŒ–è®¤çŸ¥â€ (Structured Cognition)** è¿‡ç¨‹ï¼š
*   **å¼•æ–‡çœŸå®æ€§å®¡è®¡**: å†…ç½® `Line Bounds Check`ï¼Œè‡ªåŠ¨è¯†åˆ«å¹¶è­¦å‘Šè£å†³è¿‡ç¨‹ä¸­çš„å¼•æ–‡å¹»è§‰ï¼ˆå¼•ç”¨äº†éå®æœ‰è¡Œå·ï¼‰ã€‚
*   **è§‚æµ‹åº¦å¢å¼º**: æ§åˆ¶å°å®æ—¶è¾“å‡º **â€œé€»è¾‘è„‰å†²â€ (Logic Pulse)**ï¼Œç›´æ¥æš´éœ²æ­£åæ–¹æ ¸å¿ƒå†²çªã€‚
*   **å‘½åç©ºé—´ä¿æŠ¤**: åŸºäºç›®æ ‡çš„ç›¸å¯¹è·¯å¾„è‡ªåŠ¨ç”ŸæˆæŠ¥å‘Šç›®å½•ï¼ˆå¦‚ `docs/reports/docs/mypath/`ï¼‰ï¼Œå½»åº•æ¶ˆé™¤åŒåè„šæœ¬çš„æŠ¥å‘Šå†²çªã€‚

### 3. Agent æ‰‹æœ¯æœºåˆ¶ (`The Surgeon`)
è¯¥æ­¥éª¤å¹¶éæœºæ¢°åŒ–çš„å†…å®¹è¦†ç›–ï¼Œè€Œæ˜¯ Agent åœ¨æ‰§è¡Œå‰çš„ **â€œäºŒæ¬¡åˆ›ä½œè§„åˆ’â€**ã€‚Agent ä»¥â€œå¤–ç§‘åŒ»ç”Ÿâ€çš„èº«ä»½æ“ä½œï¼š
*   **ç›®æ ‡æ€§å¯¹é½ (Objective Alignment)**: åœ¨æ”¹å†™å‰ï¼ŒAgent ä¼šä¸¥æ ¼å¯¹æ¯”è¯„å®¡æ„è§ä¸ `# Initial Optimization Objective`ï¼Œç¡®ä¿è¿­ä»£è¿‡ç¨‹ä¸­ä¸ä¼šå‡ºç°â€œç›®æ ‡æ¼‚ç§»â€ã€‚
*   **æ·±åº¦æ€ç´¢ä¸è§„åˆ’**: åˆ¶å®šä¼˜åŒ–è·¯çº¿å›¾ï¼Œç¡®ä¿æ”¹å†™åçš„å†…å®¹åœ¨å…¨å±€é€»è¾‘ä¸Šè‡ªæ´½ä¸”æµç•…ã€‚
*   **å†²çªè§£å†³ä¸çŸ¥è¯†å›ºåŒ–**: è‹¥è£å†³ä¸å†å²åˆ¤ä¾‹å†²çªï¼ŒAgent éœ€è¿›è¡Œé€»è¾‘æŠ‰æ‹©å¹¶æ›´æ–° `history_summary.md`ã€‚è¯¥æ–‡ä»¶ä¸ä»…è®°å½•å˜åŠ¨ï¼Œæ›´ä½œä¸ºâ€œæŒä¹…åŒ–è®°å¿†â€å¼•å¯¼ä¸‹ä¸€è½® Council è¾©è®ºã€‚

## ğŸš¥ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡
```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# é…ç½®ç¯å¢ƒå˜é‡ (æ¨èåœ¨ .env æ–‡ä»¶ä¸­è®¾ç½®)
# LLM_PROVIDER=gemini
# GEMINI_API_KEY=your_key_here
```

### 2. å•æ¬¡å¯¹æŠ—å¼è¯„å®¡ (Manual Debate)
è‹¥ä»…éœ€å¯¹ç‰¹å®šæ–‡æ¡£è¿›è¡Œä¸€æ¬¡æ€§è¯„å®¡å¹¶ç”ŸæˆæŠ¥å‘Šï¼š
```bash
python3 scripts/dialecta_debate.py {your_document.md} --instruction "ä½ çš„è¯„å®¡æŒ‡ä»¤"
```
*   **äº§å‡ºä½ç½®**: `docs/reports/{Relative_Path}/{TargetFile_Stem}/debate_{timestamp}.md`

### 3. è‡ªåŠ¨åŒ–æŒç»­ä¼˜åŒ–å¾ªç¯ (Automated Loop)
è¿™æ˜¯ SparkForge çš„**æ ¸å¿ƒèƒ½åŠ›**ã€‚é€šè¿‡ IDE åŠ è½½ `.agent/workflows/optimize-design-loop.md`ï¼ŒAgent å°†è‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹é—­ç¯ï¼š
1.  **è‡ªåŠ¨å®¡è®¡**: è°ƒç”¨ `dialecta_debate.py`ï¼Œæ³¨å…¥**å½“å‰ç›®æ ‡**ä¸è£å‰ªåçš„å†å²èƒŒæ™¯ï¼Œç”Ÿæˆå¸¦å…ƒæ•°æ®è¿½è¸ªçš„è¯„å®¡æ„è§ã€‚
2.  **åŸå­åŒ–ä¿æŠ¤**: åœ¨ `docs/backup/{FileName}/` åŒæ—¶å¤‡ä»½æ–‡æ¡£ä¸ `history_summary.md`ï¼Œæ”¯æŒå¤±è´¥æ—¶çš„å…¨çŠ¶æ€æ¢å¤ã€‚
3.  **æ„å›¾è¿½è¸ª (Action Trace)**: Agent åœ¨ä¿®æ”¹æ–‡æ¡£åæ˜¾å¼è®°å½•â€œå˜æ›´å½±å“çŸ©é˜µâ€ï¼Œä½œä¸ºæ„å›¾è¯æ®é“¾å¼•å¯¼ä¸‹ä¸€è½®è¯„å®¡ã€‚
4.  **çŸ¥è¯†å‹ç¼©**: æ»šåŠ¨ç»´æŠ¤å†å²æ‘˜è¦ï¼Œé€šè¿‡ `Legacy Context Summary` å‹ç¼©æ—©æœŸå†—ä½™ä¿¡æ¯ï¼Œç»´æŒ Context é«˜èƒ½æ•ˆã€‚
5.  **è‡ªæˆ‘è¿­ä»£**: è‹¥è¯„åˆ†è¾¾ä¸åˆ° 90 æˆ–æœªè¢« Approvedï¼Œè‡ªåŠ¨æºå¸¦ä¸Šä¸‹æ–‡è¿›å…¥ä¸‹ä¸€è½®ã€‚

> **æç¤º**: åœ¨ IDE ä¸­è¾“å…¥ `/optimize-design-loop` å³å¯å¿«é€Ÿå”¤èµ·è¯¥å·¥ä½œæµã€‚

---

## ğŸ‘” è®¾è®¡ç¾å­¦
*   **è¯­ä¹‰é”šç‚¹**ï¼šä½¿ç”¨ âš¡ (è¡ŒåŠ¨), ğŸ§  (åˆ†æ), ğŸ”’ (å®‰å…¨) ç­‰å›¾æ ‡å¢å¼ºè¯­ä¹‰è¯†åˆ«ã€‚
*   **å®¢è§‚ä¸¥è°¨**ï¼šæ‹’ç»ä»»ä½•æ¨¡æ£±ä¸¤å¯çš„è¡¨è¾¾ï¼Œæ‰€æœ‰ç»“è®ºå¿…é¡»åŸºäºæ•°æ®æˆ–é€»è¾‘æ¨æ¼”ã€‚
*   **è¿½æ±‚å“è¶Š**ï¼šæ–‡æ¡£ä¸ä»…ä»…æ˜¯æ–‡å­—ï¼Œæ›´æ˜¯å¯æ‰§è¡Œçš„èµ„äº§ã€‚

---
Â© 2025 SparkForge High-Fidelity Intelligence Engine.
